\hypertarget{group__uart}{\section{U\-A\-R\-T Library}
\label{group__uart}\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}}
}


U\-A\-R\-T Library enabling you to control all available U\-A\-R\-T Modules.  


\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{serial_8h}{serial.\-h}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library Header File. \end{DoxyCompactList}\item 
file \hyperlink{serial__device_8h}{serial\-\_\-device.\-h}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library device-\/specific configuration. \end{DoxyCompactList}\item 
file \hyperlink{serial_8c}{serial.\-c}
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Library Implementation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__uart_ga779bf099075a999d1074357fccbd466b}{U\-S\-B}~0
\begin{DoxyCompactList}\small\item\em First U\-A\-R\-T Name. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gab4bf926a45354a2f328f1a7b94ebd3c5}{D\-I\-S\-P\-L\-A\-Y}~1
\begin{DoxyCompactList}\small\item\em Second U\-A\-R\-T Name. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~128
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Receive Buffer Size. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~128
\begin{DoxyCompactList}\small\item\em U\-A\-R\-T Transmit Buffer Size. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gafccfd7d1315f0763ac404c6104883341}{B\-A\-U\-D}(baud\-Rate, xtal\-Cpu)~((xtal\-Cpu)/((baud\-Rate)$\ast$16l)-\/1)
\begin{DoxyCompactList}\small\item\em Calculate Baudrate Register Value. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~32
\begin{DoxyCompactList}\small\item\em If you define this, a '\textbackslash{}r' (C\-R) will be put in front of a '\textbackslash{}n' (L\-F) when sending a byte. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}~16
\begin{DoxyCompactList}\small\item\em T\-X Buffer Size in Bytes (Power of 2) \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}
\begin{DoxyCompactList}\small\item\em Defining this enables incoming X\-O\-N X\-O\-F\-F (sends X\-O\-F\-F if rx buff is full) \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{F\-L\-O\-W\-M\-A\-R\-K}~5
\begin{DoxyCompactList}\small\item\em Space remaining to trigger xoff/xon. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{X\-O\-N}~0x11
\begin{DoxyCompactList}\small\item\em X\-O\-N Value. \end{DoxyCompactList}\item 
\#define \hyperlink{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{X\-O\-F\-F}~0x13
\begin{DoxyCompactList}\small\item\em X\-O\-F\-F Value. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\-\_\-t \hyperlink{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}{serial\-Available} (void)
\begin{DoxyCompactList}\small\item\em Get number of available U\-A\-R\-T modules. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga8d59ee8831dd38c77b52deb7af9410e3}{serial\-Init} (uint8\-\_\-t uart, uint16\-\_\-t baud)
\begin{DoxyCompactList}\small\item\em Initialize the U\-A\-R\-T Hardware. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}{serial\-Close} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Stop the U\-A\-R\-T Hardware. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}{set\-Flow} (uint8\-\_\-t uart, uint8\-\_\-t on)
\begin{DoxyCompactList}\small\item\em Manually change the flow control. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{serial\-Has\-Char} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if a byte was received. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_gaa9d6e44600b215154c3f66193df151f6}{serial\-Get} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Read a single byte. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}{serial\-Get\-Blocking} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Wait until a character is received. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}{serial\-Rx\-Buffer\-Full} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the receive buffer is full. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga742268372398b85935564fded999b198}{serial\-Rx\-Buffer\-Empty} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the receive buffer is empty. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serial\-Write} (uint8\-\_\-t uart, uint8\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Send a byte. \end{DoxyCompactList}\item 
void \hyperlink{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{serial\-Write\-String} (uint8\-\_\-t uart, const char $\ast$data)
\begin{DoxyCompactList}\small\item\em Send a string. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{serial\-Tx\-Buffer\-Full} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the transmit buffer is full. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{group__uart_ga14c345ea0707111e988a80ef1da65e32}{serial\-Tx\-Buffer\-Empty} (uint8\-\_\-t uart)
\begin{DoxyCompactList}\small\item\em Check if the transmit buffer is empty. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
U\-A\-R\-T Library enabling you to control all available U\-A\-R\-T Modules. With X\-O\-N/\-X\-O\-F\-F Flow Control and buffered Receiving and Transmitting. 

\subsection{Macro Definition Documentation}
\hypertarget{group__uart_gafccfd7d1315f0763ac404c6104883341}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!B\-A\-U\-D@{B\-A\-U\-D}}
\index{B\-A\-U\-D@{B\-A\-U\-D}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{B\-A\-U\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-A\-U\-D(
\begin{DoxyParamCaption}
\item[{}]{baud\-Rate, }
\item[{}]{xtal\-Cpu}
\end{DoxyParamCaption}
)~((xtal\-Cpu)/((baud\-Rate)$\ast$16l)-\/1)}}\label{group__uart_gafccfd7d1315f0763ac404c6104883341}


Calculate Baudrate Register Value. 

\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{flight_8c-example}{flight.\-c}.\end{Desc}


Definition at line 52 of file serial.\-h.

\hypertarget{group__uart_gab4bf926a45354a2f328f1a7b94ebd3c5}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!D\-I\-S\-P\-L\-A\-Y@{D\-I\-S\-P\-L\-A\-Y}}
\index{D\-I\-S\-P\-L\-A\-Y@{D\-I\-S\-P\-L\-A\-Y}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{D\-I\-S\-P\-L\-A\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-S\-P\-L\-A\-Y~1}}\label{group__uart_gab4bf926a45354a2f328f1a7b94ebd3c5}


Second U\-A\-R\-T Name. 



Definition at line 46 of file serial.\-h.

\hypertarget{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L@{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}}
\index{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L@{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-L\-O\-W\-C\-O\-N\-T\-R\-O\-L}}\label{group__uart_gaff1f07741fbe1f53f46098687f0a05e2}


Defining this enables incoming X\-O\-N X\-O\-F\-F (sends X\-O\-F\-F if rx buff is full) 



Definition at line 64 of file serial.\-c.

\hypertarget{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!F\-L\-O\-W\-M\-A\-R\-K@{F\-L\-O\-W\-M\-A\-R\-K}}
\index{F\-L\-O\-W\-M\-A\-R\-K@{F\-L\-O\-W\-M\-A\-R\-K}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{F\-L\-O\-W\-M\-A\-R\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-L\-O\-W\-M\-A\-R\-K~5}}\label{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}


Space remaining to trigger xoff/xon. 



Definition at line 66 of file serial.\-c.



Referenced by serial\-Get().

\hypertarget{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~128}}\label{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}


U\-A\-R\-T Receive Buffer Size. 



Definition at line 48 of file serial.\-h.

\hypertarget{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~32}}\label{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}


If you define this, a '\textbackslash{}r' (C\-R) will be put in front of a '\textbackslash{}n' (L\-F) when sending a byte. 

Binary Communication will then be impossible!\-R\-X Buffer Size in Bytes (Power of 2) 

Definition at line 56 of file serial.\-c.



Referenced by serial\-Get(), serial\-Init(), and serial\-Rx\-Buffer\-Full().

\hypertarget{group__uart_ga9ab33647617098646990fe263600b650}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~128}}\label{group__uart_ga9ab33647617098646990fe263600b650}


U\-A\-R\-T Transmit Buffer Size. 



Definition at line 49 of file serial.\-h.

\hypertarget{group__uart_ga9ab33647617098646990fe263600b650}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}}
\index{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E@{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E~16}}\label{group__uart_ga9ab33647617098646990fe263600b650}


T\-X Buffer Size in Bytes (Power of 2) 



Definition at line 60 of file serial.\-c.



Referenced by serial\-Init(), serial\-Tx\-Buffer\-Full(), and serial\-Write().

\hypertarget{group__uart_ga779bf099075a999d1074357fccbd466b}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!U\-S\-B@{U\-S\-B}}
\index{U\-S\-B@{U\-S\-B}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{U\-S\-B}]{\setlength{\rightskip}{0pt plus 5cm}\#define U\-S\-B~0}}\label{group__uart_ga779bf099075a999d1074357fccbd466b}


First U\-A\-R\-T Name. 



Definition at line 45 of file serial.\-h.

\hypertarget{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!X\-O\-F\-F@{X\-O\-F\-F}}
\index{X\-O\-F\-F@{X\-O\-F\-F}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{X\-O\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-O\-F\-F~0x13}}\label{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}


X\-O\-F\-F Value. 



Definition at line 68 of file serial.\-c.



Referenced by set\-Flow().

\hypertarget{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!X\-O\-N@{X\-O\-N}}
\index{X\-O\-N@{X\-O\-N}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{X\-O\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\-O\-N~0x11}}\label{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}


X\-O\-N Value. 



Definition at line 67 of file serial.\-c.



Referenced by serial\-Get(), and set\-Flow().



\subsection{Function Documentation}
\hypertarget{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Available@{serial\-Available}}
\index{serial\-Available@{serial\-Available}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Available}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Available (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{group__uart_ga1ea963b291215ad9c5e8a0610f116b90}


Get number of available U\-A\-R\-T modules. 

\begin{DoxyReturn}{Returns}
number of modules 
\end{DoxyReturn}


Definition at line 115 of file serial.\-c.


\begin{DoxyCode}
115                               \{
116     \textcolor{keywordflow}{return} UART\_COUNT;
117 \}
\end{DoxyCode}
\hypertarget{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Close@{serial\-Close}}
\index{serial\-Close@{serial\-Close}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Close}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Close (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaa16a5ecaf9e40660ded50737ff1d0a88}


Stop the U\-A\-R\-T Hardware. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to stop \\
\hline
\end{DoxyParams}


Definition at line 172 of file serial.\-c.



References B\-A\-N\-K\-\_\-\-S\-E\-R\-I\-A\-L, M\-E\-M\-S\-W\-I\-T\-C\-H, M\-E\-M\-S\-W\-I\-T\-C\-H\-B\-A\-C\-K, and serial\-Tx\-Buffer\-Empty().


\begin{DoxyCode}
172                                \{
173     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
174         \textcolor{keywordflow}{return};
175 
176     \hyperlink{group__xmem_ga253830e5022f2aa99177acd8a0ba0bfe}{MEMSWITCH}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
177     uint8\_t sreg = SREG;
178     sei();
179     \textcolor{keywordflow}{while} (!\hyperlink{group__uart_ga14c345ea0707111e988a80ef1da65e32}{serialTxBufferEmpty}(uart));
180     \textcolor{keywordflow}{while} (*serialRegisters[uart][SERIALB] & (1 << serialBits[uart][SERIALUDRIE])); \textcolor{comment}{// Wait while Transmit
       Interrupt is on}
181     cli();
182     *serialRegisters[uart][SERIALB] = 0;
183     *serialRegisters[uart][SERIALC] = 0;
184     SREG = sreg;
185     free(rxBuffer[uart]);
186     free(txBuffer[uart]);
187     \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
188 \}
\end{DoxyCode}
\hypertarget{group__uart_gaa9d6e44600b215154c3f66193df151f6}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Get@{serial\-Get}}
\index{serial\-Get@{serial\-Get}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Get}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Get (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaa9d6e44600b215154c3f66193df151f6}


Read a single byte. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Received byte or 0 
\end{DoxyReturn}


Definition at line 245 of file serial.\-c.



References B\-A\-N\-K\-\_\-\-S\-E\-R\-I\-A\-L, F\-L\-O\-W\-M\-A\-R\-K, M\-E\-M\-S\-W\-I\-T\-C\-H, M\-E\-M\-S\-W\-I\-T\-C\-H\-B\-A\-C\-K, R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E, and X\-O\-N.



Referenced by serial\-Get\-Blocking().


\begin{DoxyCode}
245                                 \{
246     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
247         \textcolor{keywordflow}{return} 0;
248 
249     uint8\_t c;
250     \hyperlink{group__xmem_ga253830e5022f2aa99177acd8a0ba0bfe}{MEMSWITCH}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
251 \textcolor{preprocessor}{#ifdef FLOWCONTROL}
252 \textcolor{preprocessor}{}    rxBufferElements[uart]--;
253     \textcolor{keywordflow}{if} ((flow[uart] == 0) && (rxBufferElements[uart] <= \hyperlink{group__uart_gaa7907a070ef8e6d68d7d774b34eebe66}{FLOWMARK})) \{
254         \textcolor{keywordflow}{while} (sendThisNext[uart] != 0);
255         sendThisNext[uart] = \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{XON};
256         flow[uart] = 1;
257         \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
258             shouldStartTransmission[uart] = 0;
259             *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]); \textcolor{comment}{// Enable Interrupt}
260             *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger Interrupt}
261         \}
262     \}
263 \textcolor{preprocessor}{#endif}
264 \textcolor{preprocessor}{}
265     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{
266         c = rxBuffer[uart][rxRead[uart]];
267         rxBuffer[uart][rxRead[uart]] = 0;
268         \textcolor{keywordflow}{if} (rxRead[uart] < (\hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{RX\_BUFFER\_SIZE} - 1)) \{
269             rxRead[uart]++;
270         \} \textcolor{keywordflow}{else} \{
271             rxRead[uart] = 0;
272         \}
273         \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
274         \textcolor{keywordflow}{return} c;
275     \} \textcolor{keywordflow}{else} \{
276         \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
277         \textcolor{keywordflow}{return} 0;
278     \}
279 \}
\end{DoxyCode}
\hypertarget{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Get\-Blocking@{serial\-Get\-Blocking}}
\index{serial\-Get\-Blocking@{serial\-Get\-Blocking}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Get\-Blocking}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Get\-Blocking (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_gaf7c4238a9a5e8fff64af1faf1689a5a4}


Wait until a character is received. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Received byte 
\end{DoxyReturn}


Definition at line 237 of file serial.\-c.



References serial\-Get(), and serial\-Has\-Char().


\begin{DoxyCode}
237                                         \{
238     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
239         \textcolor{keywordflow}{return} 0;
240 
241     \textcolor{keywordflow}{while}(!\hyperlink{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{serialHasChar}(uart));
242     \textcolor{keywordflow}{return} \hyperlink{group__uart_gaa9d6e44600b215154c3f66193df151f6}{serialGet}(uart);
243 \}
\end{DoxyCode}
\hypertarget{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Has\-Char@{serial\-Has\-Char}}
\index{serial\-Has\-Char@{serial\-Has\-Char}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Has\-Char}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Has\-Char (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga266a54dcf3c4b85d92bf6b16bdcb5069}


Check if a byte was received. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if a byte was received, 0 if not 
\end{DoxyReturn}


Definition at line 226 of file serial.\-c.



Referenced by serial\-Get\-Blocking().


\begin{DoxyCode}
226                                     \{
227     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
228         \textcolor{keywordflow}{return} 0;
229 
230     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{ \textcolor{comment}{// True if char available}
231         \textcolor{keywordflow}{return} 1;
232     \} \textcolor{keywordflow}{else} \{
233         \textcolor{keywordflow}{return} 0;
234     \}
235 \}
\end{DoxyCode}
\hypertarget{group__uart_ga8d59ee8831dd38c77b52deb7af9410e3}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Init@{serial\-Init}}
\index{serial\-Init@{serial\-Init}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Init}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Init (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint16\-\_\-t}]{baud}
\end{DoxyParamCaption}
)}}\label{group__uart_ga8d59ee8831dd38c77b52deb7af9410e3}


Initialize the U\-A\-R\-T Hardware. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to initialize \\
\hline
{\em baud} & Baudrate. Use the \hyperlink{group__uart_gafccfd7d1315f0763ac404c6104883341}{B\-A\-U\-D()} macro! \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if not enough memory for buffers, 0 on success 
\end{DoxyReturn}
\begin{Desc}
\item[Examples\-: ]\par
\hyperlink{flight_8c-example}{flight.\-c}.\end{Desc}


Definition at line 119 of file serial.\-c.



References B\-A\-N\-K\-\_\-\-S\-E\-R\-I\-A\-L, M\-E\-M\-S\-W\-I\-T\-C\-H, M\-E\-M\-S\-W\-I\-T\-C\-H\-B\-A\-C\-K, R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E, and T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.


\begin{DoxyCode}
119                                                 \{
120     \textcolor{keywordflow}{if} (uart >= UART\_COUNT) \{
121         \textcolor{keywordflow}{for} (uint8\_t i = 0; i < UART\_COUNT; i++) \{
122             \hyperlink{group__uart_ga8d59ee8831dd38c77b52deb7af9410e3}{serialInit}(i, baud);
123         \}
124     \}
125 
126     \hyperlink{group__xmem_ga253830e5022f2aa99177acd8a0ba0bfe}{MEMSWITCH}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
127 
128     rxBuffer[uart] = (uint8\_t *)malloc(\hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{RX\_BUFFER\_SIZE});
129     \textcolor{keywordflow}{if} (rxBuffer[uart] == NULL) \{
130         \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
131         \textcolor{keywordflow}{return} 1;
132     \}
133 
134     txBuffer[uart] = (uint8\_t *)malloc(\hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{TX\_BUFFER\_SIZE});
135     \textcolor{keywordflow}{if} (txBuffer[uart] == NULL) \{
136         free((\textcolor{keywordtype}{void} *)rxBuffer[uart]);
137         \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
138         \textcolor{keywordflow}{return} 1;
139     \}
140 
141     \textcolor{comment}{// Initialize state variables}
142     rxRead[uart] = 0;
143     rxWrite[uart] = 0;
144     txRead[uart] = 0;
145     txWrite[uart] = 0;
146     shouldStartTransmission[uart] = 1;
147 \textcolor{preprocessor}{#ifdef FLOWCONTROL}
148 \textcolor{preprocessor}{}    sendThisNext[uart] = 0;
149     flow[uart] = 1;
150     rxBufferElements[uart] = 0;
151 \textcolor{preprocessor}{#endif}
152 \textcolor{preprocessor}{}
153     \textcolor{comment}{// Default Configuration: 8N1}
154     *serialRegisters[uart][SERIALC] = (1 << serialBits[uart][SERIALUCSZ0]) | (1 << serialBits[uart][
      SERIALUCSZ1]);
155 
156     \textcolor{comment}{// Set baudrate}
157 \textcolor{preprocessor}{#if SERIALBAUDBIT == 8}
158 \textcolor{preprocessor}{}    *serialRegisters[uart][SERIALUBRRH] = (baud >> 8);
159     *serialRegisters[uart][SERIALUBRRL] = baud;
160 \textcolor{preprocessor}{#else}
161 \textcolor{preprocessor}{}    *serialBaudRegisters[uart] = baud;
162 \textcolor{preprocessor}{#endif}
163 \textcolor{preprocessor}{}
164     *serialRegisters[uart][SERIALB] = (1 << serialBits[uart][SERIALRXCIE]); \textcolor{comment}{// Enable Interrupts}
165     *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALRXEN]) | (1 << serialBits[uart][
      SERIALTXEN]); \textcolor{comment}{// Enable Receiver/Transmitter}
166 
167     \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
168 
169     \textcolor{keywordflow}{return} 0;
170 \}
\end{DoxyCode}
\hypertarget{group__uart_ga742268372398b85935564fded999b198}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Rx\-Buffer\-Empty@{serial\-Rx\-Buffer\-Empty}}
\index{serial\-Rx\-Buffer\-Empty@{serial\-Rx\-Buffer\-Empty}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Rx\-Buffer\-Empty}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Rx\-Buffer\-Empty (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga742268372398b85935564fded999b198}


Check if the receive buffer is empty. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is empty, 0 if not. 
\end{DoxyReturn}


Definition at line 288 of file serial.\-c.


\begin{DoxyCode}
288                                           \{
289     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
290         \textcolor{keywordflow}{return} 0;
291 
292     \textcolor{keywordflow}{if} (rxRead[uart] != rxWrite[uart]) \{
293         \textcolor{keywordflow}{return} 0;
294     \} \textcolor{keywordflow}{else} \{
295         \textcolor{keywordflow}{return} 1;
296     \}
297 \}
\end{DoxyCode}
\hypertarget{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Rx\-Buffer\-Full@{serial\-Rx\-Buffer\-Full}}
\index{serial\-Rx\-Buffer\-Full@{serial\-Rx\-Buffer\-Full}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Rx\-Buffer\-Full}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Rx\-Buffer\-Full (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga73d16b244172336e7306ea2e4cf90fa1}


Check if the receive buffer is full. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is full, 0 if not 
\end{DoxyReturn}


Definition at line 281 of file serial.\-c.



References R\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.


\begin{DoxyCode}
281                                          \{
282     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
283         \textcolor{keywordflow}{return} 0;
284 
285     \textcolor{keywordflow}{return} (((rxWrite[uart] + 1) == rxRead[uart]) || ((rxRead[uart] == 0) && ((rxWrite[uart] + 1) == 
      \hyperlink{group__uart_ga739a2a1a0047c98ac1b18ecd25dac092}{RX\_BUFFER\_SIZE})));
286 \}
\end{DoxyCode}
\hypertarget{group__uart_ga14c345ea0707111e988a80ef1da65e32}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Tx\-Buffer\-Empty@{serial\-Tx\-Buffer\-Empty}}
\index{serial\-Tx\-Buffer\-Empty@{serial\-Tx\-Buffer\-Empty}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Tx\-Buffer\-Empty}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Tx\-Buffer\-Empty (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga14c345ea0707111e988a80ef1da65e32}


Check if the transmit buffer is empty. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is empty, 0 if not. 
\end{DoxyReturn}


Definition at line 349 of file serial.\-c.



Referenced by serial\-Close().


\begin{DoxyCode}
349                                           \{
350     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
351         \textcolor{keywordflow}{return} 0;
352 
353     \textcolor{keywordflow}{if} (txRead[uart] != txWrite[uart]) \{
354         \textcolor{keywordflow}{return} 0;
355     \} \textcolor{keywordflow}{else} \{
356         \textcolor{keywordflow}{return} 1;
357     \}
358 \}
\end{DoxyCode}
\hypertarget{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Tx\-Buffer\-Full@{serial\-Tx\-Buffer\-Full}}
\index{serial\-Tx\-Buffer\-Full@{serial\-Tx\-Buffer\-Full}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Tx\-Buffer\-Full}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t serial\-Tx\-Buffer\-Full (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart}
\end{DoxyParamCaption}
)}}\label{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}


Check if the transmit buffer is full. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if buffer is full, 0 if not 
\end{DoxyReturn}


Definition at line 342 of file serial.\-c.



References T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.



Referenced by serial\-Write().


\begin{DoxyCode}
342                                          \{
343     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
344         \textcolor{keywordflow}{return} 0;
345 
346     \textcolor{keywordflow}{return} (((txWrite[uart] + 1) == txRead[uart]) || ((txRead[uart] == 0) && ((txWrite[uart] + 1) == 
      \hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{TX\_BUFFER\_SIZE})));
347 \}
\end{DoxyCode}
\hypertarget{group__uart_ga388583adaa7db4fad121b6454668b347}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Write@{serial\-Write}}
\index{serial\-Write@{serial\-Write}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Write}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Write (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint8\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{group__uart_ga388583adaa7db4fad121b6454668b347}


Send a byte. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to write to \\
\hline
{\em data} & Byte to send \\
\hline
\end{DoxyParams}


Definition at line 303 of file serial.\-c.



References B\-A\-N\-K\-\_\-\-S\-E\-R\-I\-A\-L, M\-E\-M\-S\-W\-I\-T\-C\-H, M\-E\-M\-S\-W\-I\-T\-C\-H\-B\-A\-C\-K, serial\-Tx\-Buffer\-Full(), and T\-X\-\_\-\-B\-U\-F\-F\-E\-R\-\_\-\-S\-I\-Z\-E.



Referenced by serial\-Write\-String().


\begin{DoxyCode}
303                                              \{
304     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
305         \textcolor{keywordflow}{return};
306 
307     \hyperlink{group__xmem_ga253830e5022f2aa99177acd8a0ba0bfe}{MEMSWITCH}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
308 \textcolor{preprocessor}{#ifdef SERIALINJECTCR}
309 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (data == \textcolor{charliteral}{'\(\backslash\)n'}) \{
310         \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serialWrite}(uart, \textcolor{charliteral}{'\(\backslash\)r'});
311     \}
312 \textcolor{preprocessor}{#endif}
313 \textcolor{preprocessor}{}    \textcolor{keywordflow}{while} (\hyperlink{group__uart_ga8a6adfd3c350ceb55605d003a62a36a4}{serialTxBufferFull}(uart));
314 
315     txBuffer[uart][txWrite[uart]] = data;
316     \textcolor{keywordflow}{if} (txWrite[uart] < (\hyperlink{group__uart_ga9ab33647617098646990fe263600b650}{TX\_BUFFER\_SIZE} - 1)) \{
317         txWrite[uart]++;
318     \} \textcolor{keywordflow}{else} \{
319         txWrite[uart] = 0;
320     \}
321     \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
322         shouldStartTransmission[uart] = 0;
323         *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]); \textcolor{comment}{// Enable Interrupt}
324         *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger Interrupt}
325     \}
326     \hyperlink{group__xmem_ga96199c8c5e6fbc65dd60aa67de63fd34}{MEMSWITCHBACK}(\hyperlink{group__xmem_gaa5177871b2303418ed492a18405273f9}{BANK\_SERIAL});
327 \}
\end{DoxyCode}
\hypertarget{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!serial\-Write\-String@{serial\-Write\-String}}
\index{serial\-Write\-String@{serial\-Write\-String}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{serial\-Write\-String}]{\setlength{\rightskip}{0pt plus 5cm}void serial\-Write\-String (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{const char $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}


Send a string. 


\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to write to \\
\hline
{\em data} & Null-\/\-Terminated String \\
\hline
\end{DoxyParams}


Definition at line 329 of file serial.\-c.



References serial\-Write().


\begin{DoxyCode}
329                                                        \{
330     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
331         \textcolor{keywordflow}{return};
332 
333     \textcolor{keywordflow}{if} (data == 0) \{
334         \hyperlink{group__uart_ga054d68834f9ca19f3b2cf9d714337de4}{serialWriteString}(uart, \textcolor{stringliteral}{"NULL"});
335     \} \textcolor{keywordflow}{else} \{
336         \textcolor{keywordflow}{while} (*data != \textcolor{charliteral}{'\(\backslash\)0'}) \{
337             \hyperlink{group__uart_ga388583adaa7db4fad121b6454668b347}{serialWrite}(uart, *data++);
338         \}
339     \}
340 \}
\end{DoxyCode}
\hypertarget{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}{\index{U\-A\-R\-T Library@{U\-A\-R\-T Library}!set\-Flow@{set\-Flow}}
\index{set\-Flow@{set\-Flow}!UART Library@{U\-A\-R\-T Library}}
\subsubsection[{set\-Flow}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Flow (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{uart, }
\item[{uint8\-\_\-t}]{on}
\end{DoxyParamCaption}
)}}\label{group__uart_ga5d5de9e3ed5a0be11f707113cfff33f5}


Manually change the flow control. 

Flow Control has to be compiled into the library! 
\begin{DoxyParams}{Parameters}
{\em uart} & U\-A\-R\-T Module to operate on \\
\hline
{\em on} & 1 of on, 0 if off \\
\hline
\end{DoxyParams}


Definition at line 191 of file serial.\-c.



References X\-O\-F\-F, and X\-O\-N.


\begin{DoxyCode}
191                                        \{
192     \textcolor{keywordflow}{if} (uart >= UART\_COUNT)
193         \textcolor{keywordflow}{return};
194 
195     \textcolor{keywordflow}{if} (flow[uart] != on) \{
196         \textcolor{keywordflow}{if} (on == 1) \{
197             \textcolor{comment}{// Send XON}
198             \textcolor{keywordflow}{while} (sendThisNext[uart] != 0);
199             sendThisNext[uart] = \hyperlink{group__uart_gacdf721774c51e08c6609e6fa8cf82cc9}{XON};
200             flow[uart] = 1;
201             \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
202                 shouldStartTransmission[uart] = 0;
203                 *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]);
204                 *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger
       Interrupt}
205             \}
206         \} \textcolor{keywordflow}{else} \{
207             \textcolor{comment}{// Send XOFF}
208             sendThisNext[uart] = \hyperlink{group__uart_ga67fd78ae15d2b67c10d44d69a49ab1c5}{XOFF};
209             flow[uart] = 0;
210             \textcolor{keywordflow}{if} (shouldStartTransmission[uart]) \{
211                 shouldStartTransmission[uart] = 0;
212                 *serialRegisters[uart][SERIALB] |= (1 << serialBits[uart][SERIALUDRIE]);
213                 *serialRegisters[uart][SERIALA] |= (1 << serialBits[uart][SERIALUDRE]); \textcolor{comment}{// Trigger
       Interrupt}
214             \}
215         \}
216         \textcolor{comment}{// Wait till it's transmitted}
217         \textcolor{keywordflow}{while} (*serialRegisters[uart][SERIALB] & (1 << serialBits[uart][SERIALUDRIE]));
218     \}
219 \}
\end{DoxyCode}
